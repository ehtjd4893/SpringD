<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.team.d.dao.MemberDAO">

<!-- 로그인(login) -->


<select resultType="com.team.d.dto.MemberDTO" id="login">
SELECT MNO, MNAME, MID, MPW, MEMAIL, MPHONE, MGRADE, MREGDATE, STATUS
FROM MEMBER
WHERE MID = #{mId}AND MPW = #{mPw} 
</select>

<!-- 카카오 로그인(loginKakao) -->


<select resultType="com.team.d.dto.MemberDTO" id="kakaoLogin">
SELECT MNO, MNAME, MID, MPW, MEMAIL, MPHONE, MGRADE, MREGDATE, STATUS
FROM MEMBER
WHERE MEMAIL = #{mEmail} 
</select>

<!-- 회원가입(join) -->


<insert id="join">
INSERT INTO MEMBER
VALUES (MEMBER_SEQ.NEXTVAL, #{mName}, #{mId}, #{mPw}, #{mEmail}, #{mPhone}, 'bronze', SYSDATE, 0) 
</insert>

<!-- 아이디 체크(idCheck) -->


<select resultType="int" id="idCheck">
SELECT COUNT(MNO)
FROM MEMBER
WHERE MID = #{mId} 
</select>

<!-- 이메일 체크(emailCheck) -->


<select resultType="int" id="emailCheck">
SELECT COUNT(MEMAIL)
FROM MEMBER
WHERE MEMAIL = #{mEmail} 
</select>

<!-- 비밀번호 변경(updatePw) -->


<update id="updatePw">
UPDATE MEMBER
SET MPW = #{mPw}
WHERE MNO = #{mNo} 
</update>

<!-- 회원정보 변경(updateMember): 이름, 전화번호, 이메일 -->


<update id="updateMember">
UPDATE MEMBER
SET MNAME = #{mName}, MPHONE = #{mPhone}, MEMAIL = #{mEmail}
WHERE MNO = #{mNo} 
</update>

<!-- 아이디 찾기(findId) -->


<select resultType="com.team.d.dto.MemberDTO" id="findId">
SELECT MIDFROM MEMBER
WHERE MNAME = #{mName}
AND MEMAIL = #{mEmail} 
</select>

<!-- 비밀번호 찾기&변경(findPw) -->


<select resultType="com.team.d.dto.MemberDTO" id="findPw">
SELECT *FROM MEMBER
WHERE MID = #{mId}
AND MEMAIL = #{mEmail} 
</select>

<!-- 비밀번호 찾기&변경(changePw) -->


<update id="changePw">
UPDATE MEMBER
SET MPW = #{mPw}
WHERE MEMAIL = #{mEmail} 
</update>

<!-- 회원탈퇴(leave) -->


  <update id="leave">
      UPDATE MEMBER
         SET STATUS = -1
       WHERE MNO = #{mNo}
   </update>

<!-- <update id="leave">UPDATE MEMBERSET STATUS = -1WHERE MNO = #{mNo}</update> -->


<!-- 재가입(reJoin) : STATUS 0으로 변경 <update id="reJoin">UPDATE MEMBERWHERE MNO = #{mNo}</update> -->


<!-- 관리자 로그인(login) -->


<select resultType="com.team.d.dto.MemberDTO" id="adminLogin" parameterType="com.team.d.dto.MemberDTO">
SELECT MNAME, MID, MPW
FROM ADMIN
WHERE MID = #{mId}AND MPW = #{mPw} 
</select>

</mapper>